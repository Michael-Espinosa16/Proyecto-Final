<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Llamado a bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Llamado al modal de la tabla -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- Llamado a jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- Llamado a funciones npm -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Llamado al correo -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <!-- Lamada a seccion de pdf -->
    <script src="js/jsPDF-1.3.2/dist/jspdf.min.js"></script>
    <!-- Llamada a la librería de Sweet Alert 2 -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Llamado de js en orden -->
    <script src="js/verificacion.js"></script>
    <script src="js/capturar_recambios.js"></script>
    <script src="js/condicion_p_arterial.js"></script>
    <script src="js/alertas.js"></script>
    <script src="js/correo.js"></script>
    <script src="js/pdf.js"></script>
    <script src="js/grafica.js"></script>
    <script src="js/alertas_mixtas.js"></script>

    <script type="text/javascript"> (function(){emailjs.init("yOg4Ak1eAhgPG_qyg");})();</script>
    <link rel="stylesheet" href="css/estilos.css">

    

    <title>Proyecto Final</title>
</head>
<body>

  <!-- Barra de navegación -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="captura_datos.html">Reportes</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="citas.html">Citas</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- Fin de barra de navegación -->

    <header>
        <div>
            <h1 class="text-center text-white">REPORTE DE BALANCE HÍDRICO - DIÁLISIS PERITONEAL</h1>
        </div>
    </header>
    
    <form class="form-control-sm bg-transparent" id="formulario" method="POST">
      <div class="container-sm .table-responsive w-50 my-4 mx-auto bg-light bg-gradient p-3 rounded-3">

        <!-- Sección de los datos del paciente -->

        <!-- Paciente -->
        <div class="row mb-3">
          <label for="nombre_paciente" class="col-sm-2 col-form-label">Paciente</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" id="nombre_paciente" name="nombre_paciente" required autofocus>
          </div>
        </div>

        <!-- Fecha -->
        <div class="row mb-3">
          <label for="fecha_tratamiento" class="col-sm-2 col-form-label">Fecha</label>
          <div class="col-sm-10">
            <input type="date" class="form-control" id="fecha_tratamiento" name="fecha_tratamiento" required>
          </div>
        </div>

        <!-- Tipo de sistema -->
        <div class="row mb-3">
          <label for="tipo_sistemadp" class="col-sm-2 col-form-label">Sistema</label>
          <div class="col-sm-10">
            <select id="tipo_sistemadp" class="form-select form-select-sm" name="tipo_sistemadp" required>
              <option disabled selected="">Elija un tipo de sistema</option>
              <option value="Baxter">Baxter</option>
              <option value="Fresenius Medical Care">Fresenius Medical Care</option>
            </select>
          </div>
        </div>

        <!-- Presión arterial -->
        <div class="input-group">
          <span class="input-group-text bg-dark text-white">Presión Arterial</span>
          <input id="sist" type="number" aria-label="Sístole" placeholder="Sístole" name="sist" class="form-control" >
          <input id="dist" type="number" aria-label="Diástole" placeholder="Diástole" class="form-control" name="dist">
        </div>
      </div>

      <!-- Separador -->
      <div class="w-100 d-inline-block bg-gradient rounded-pill border border-light" style="background-color: rgba(5, 82, 183, 1); height: 15px">
      </div>
      <!-- Separador -->

      <!-- Sección de los datos del reporte -->
      <div class="container-sm table-responsive my-4 mx-auto">
        <table class="table table-bordered border-primary">
            <thead class="bg-primary bg-gradient text-white">
              <tr>
                <th scope="col" rowspan="2" class="text-center">RECAMBIO</th>
                <th scope="col" colspan="2" class="text-center">FASE I</th>
                <th scope="col" colspan="2" class="text-center">FASE II</th>
                <th scope="col" rowspan="2" class="text-center">BALANCE</th>
              </tr>
              <tr>
                <th scope="col">CONCENTRACIÓN</th>
                <th scope="col">INFUSIÓN</th>
                <th scope="col">DRENAJE</th>
                <th scope="col">CUALIDAD</th>
              </tr>
      
            </thead>

          <tbody class="transparente text-white">
            <!-- Fila 1 de la tabla -->
            
            <tr>
              <th scope="row">1</th>
              
              <!-- Seleccion del porcentaje de concentracion -->
              <td>
                <select id="concentracion_1" class="form-select form-select-sm" name="concentracion_1">
                  <option disabled selected="">Elija un porcentaje</option>
                  <option value=0.015>1.5%</option>
                  <option value=0.025>2.5%</option>
                  <option value=0.075>7.5%</option>
                </select>
              </td>

              <!-- dato estatico -->
              <td class="form-control text-center text-white" >2000 ml.</td>

              <!-- dato introducido por el usuario -->
              <td><input type="number" class="form-control bg-transparent text-white" id="dr_ml_1" name="dr_ml_1"></td>
              
              <!-- Seleccion del tipo de cualidad -->
              <td>
                <select id="cualidad_1" class="form-select form-select-sm" name="cualidad_1">
                  <option disabled selected="">Elija un tipo</option>
                  <option value="claro">Claro (normal)</option>
                  <option value="turbio">Turbio (con irregularidad)</option>
                </select>
              </td>
              
              <!-- Introduccion del balance -->
              <td id="tot_bal_1" class="text-white text-center" name="tot_bal_1"></td>
            </tr>

            <!-- Fila 2 de la tabla -->

            <tr>
              <th scope="row">2</th>
              <td>
                <select id="concentracion_2" class="form-select form-select-sm" name="concentracion_2">
                  <option disabled selected="">Elija un porcentaje</option>
                  <option value=0.015>1.5%</option>
                  <option value=0.025>2.5%</option>
                  <option value=0.075>7.5%</option>
                </select>
              </td>
              <td class="form-control text-center text-white" >2000 ml.</td>
              <td><input type="number" class="form-control bg-transparent text-white" id="dr_ml_2" name="dr_ml_2"></td>
              <td>
                <select id="cualidad_2" class="form-select form-select-sm" name="cualidad_2">
                  <option disabled selected="">Elija un tipo</option>
                  <option value="claro">Claro (normal)</option>
                  <option value="turbio">Turbio (con irregularidad)</option>
                </select>
              </td>
              <td id="tot_bal_2" class="text-white text-center" name="tot_bal_2"></td>
            </tr>

            <!-- Fila 3 de la tabla -->
            
            <tr>
              <th scope="row">3</th>
              <td>
                <select id="concentracion_3" class="form-select form-select-sm" name="concentracion_3">
                  <option disabled selected="">Elija un porcentaje</option>
                  <option value=0.015>1.5%</option>
                  <option value=0.025>2.5%</option>
                  <option value=0.075>7.5%</option>
                </select>
              </td>
              <td class="form-control text-center text-white">2000 ml.</td>
              <td><input type="number" class="form-control bg-transparent text-white" id="dr_ml_3" name="dr_ml_3"></td>
              <td>
                <select id="cualidad_3" class="form-select form-select-sm" name="cualidad_3">
                  <option disabled selected="">Elija un tipo</option>
                  <option value="claro">Claro (normal)</option>
                  <option value="turbio">Turbio (con irregularidad)</option>
                </select>
              </td>
              <td id="tot_bal_3" class="text-white text-center" name="tot_bal_3"></td>
            </tr>

            <!-- Fila 4 de la tabla -->

            <tr>
              <th scope="row">4</th>
              <td>
                <select id="concentracion_4" class="form-select form-select-sm" name="concentracion_4">
                  <option disabled selected="">Elija un porcentaje</option>
                  <option value=0.015>1.5%</option>
                  <option value=0.025>2.5%</option>
                  <option value=0.075>7.5%</option>
                </select>
              </td>
              <td class="form-control text-center text-white">2000 ml.</td>
              <td><input type="number" class="form-control bg-transparent text-white" id="dr_ml_4" name="dr_ml_4"></td>
              <td>
                <select id="cualidad_4" class="form-select form-select-sm" name="cualidad_4">
                  <option disabled selected="">Elija un tipo</option>
                  <option value="claro">Claro (normal)</option>
                  <option value="turbio">Turbio (con irregularidad)</option>
                </select>
              </td>
              <td id="tot_bal_4" class="text-white text-center" name="tot_bal_4"></td>
            </tr>

            <!-- Fila 4 para los totales -->

            <tr class="text-white">
              <th scope="row" class="">Total:</th>
              <td></td>
              <td class="form-control text-center text-white" >8000 ml.</td>
              <td id="drenaje_tot" name="drenaje_tot"></td>
              <td></td>
              <td id="tot_bal_final" name="tot_bal_final"> </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Boton para realizar los calculos -->
      
    </form>
    
    <div class="d-grid gap-2 col-3 mx-auto">
      
      <button id="boton1" name="boton1" type="submit" class="btn btn-primary" onclick=" verify();" >Calcular</button>
      <button id="cmd" type="button" class="btn btn-primary" onclick="descargar()">Descargar</button> 
      <button type="button" class="mx-0 my-5 btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalGrafica" onclick="grafica();">Visualizar gráfica del análisis</button>   
    </div>

    <!-- Separador -->
    <div class="w-100 d-inline-block bg-gradient rounded-pill border border-light" style="background-color: rgba(5, 82, 183, 1); height: 15px">
    </div>
    <!-- Separador -->
    
    <div id="XD" class="container-sm table-responsive w-75 my-4 mx-auto">
      <table id="resultados" class="table">
        <thead>
          <tr><th scope="col" class="text-center text-white bg-primary rounded-top">Análisis de resultados para el paciente</th></tr>
          <tr><td id="resultado_drenaje" class="text-white transparente"></td></tr>
          <tr><td id="resultado_cualidad" class="text-white transparente"></td></tr>
          <tr><td id="resultado_presion" class="text-white transparente"></td></tr>
          
        </thead>
      </table>
    </div>



    <!-- Modal que mostrará la gráfica -->
    <div class="modal fade" id="modalGrafica" tabindex="-1" aria-hidden="true" aria-labelledby="modalTitle" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered modal-xl">
          <div class="modal-content">

              <!-- cabecera del modal -->
              <div class="modal-header bg-dark text-white">
                  <h6 class="modal-title lead fw-bold" id="modalTitle">Análisis de Resultados del Balance Hídrico</h6>
                  <button onclick="destroyCanvas()" type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>

              <!-- body del modal -->
              <div class="modal-body">
                  <div class="my-3 mx-auto">
                      <canvas id="balanceGrafica" height="100"></canvas>
                  </div>
              </div>

              <!-- pie del modal -->
              <div class="modal-footer"></div>

          </div>
      </div>
  </div>
  
  <script src="js/enviar_datos.js"></script>

  </body>
</html>